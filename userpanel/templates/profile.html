{% extends "base_userpanel.html" %}

{% block title %}My Profile - Walkoria{% endblock %}

{% block breadcrumb %}
<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'home' %}">Home</a></li>
        <li class="breadcrumb-item active">My Profile</li>
    </ol>
</nav>
{% endblock %}

{% block content %}
<div class="content-card">
    <h2 class="page-title">My Profile</h2>
    
    <div class="row">
        <div class="col-md-4 text-center mb-4">
            <div class="profile-image-container">
                {% if user.profile_image %}
                    <img src="{{ user.profile_image }}" alt="Profile Picture" class="profile-image">
                {% else %}
                    <div class="profile-placeholder">
                        <i class="fas fa-user"></i>
                    </div>
                {% endif %}
            </div>
        </div>
        
        <div class="col-md-8">
            <div class="profile-details">
                <div class="row mb-3">
                <div class="col-sm-4"><strong>Full Name:</strong></div>
                <div class="col-sm-8">
                    {% if user.first_name %}
                        {{ user.first_name|title }}{% if user.last_name %} {{ user.last_name|title }}{% endif %}
                    {% else %}
                        Not provided
                    {% endif %}
                </div>
            </div>

                
                <div class="row mb-3">
                    <div class="col-sm-4"><strong>Email:</strong></div>
                    <div class="col-sm-8">{{ user.email }}</div>
                </div>
                
                <div class="row mb-3">
                    <div class="col-sm-4"><strong>Mobile Number:</strong></div>
                    <div class="col-sm-8">{{ user.mobile_no|default:"Not provided" }}</div>
                </div>
                
                <div class="row mb-3">
                    <div class="col-sm-4"><strong>Member Since:</strong></div>
                    <div class="col-sm-8">{{ user.date_joined|date:"F d, Y" }}</div>
                </div>
                
                <div class="row mb-3">
                    <div class="col-sm-4"><strong>Account Status:</strong></div>
                    <div class="col-sm-8">
                        <span class="badge bg-success">Active</span>
                    </div>
                </div>
            </div>
            
            <div class="profile-actions mt-4">
                <a href="{% url 'update_profile' %}" class="btn btn-primary me-2">
                    <i class="fas fa-edit"></i> Edit Profile
                </a>
                <a href="{% url 'change_password' %}" class="btn btn-secondary">
                    <i class="fas fa-key"></i> Change Password
                </a>
            </div>
        </div>
    </div>
    
    <!-- Address Section -->
    <hr class="my-4">
    <h4>My Addresses</h4>
    
    {% if user.address.all %}
        <div class="row">
            {% for address in user.address.all %}
                {% if not address.is_deleted %}
                    <div class="col-md-6 mb-3">
                        <div class="address-card">
                            <div class="address-header">
                                <h6>{{ address.full_name }}</h6>
                                {% if address.default_address %}
                                    <span class="badge bg-primary">Default</span>
                                {% endif %}
                            </div>
                            <p class="address-text">
                                {{ address.address }}<br>
                                {{ address.street }}{% if address.landmark %}, {{ address.landmark }}{% endif %}<br>
                                {{ address.city }}, {{ address.get_state_display }} - {{ address.pin_code }}<br>
                                <strong>Mobile:</strong> {{ address.mobile_no }}
                            </p>
                        </div>
                    </div>
                {% endif %}
            {% endfor %}
        </div>
    {% else %}
        <p class="text-muted">No addresses added yet.</p>
    {% endif %}
    
    <a href="{% url 'manage_address' %}" class="btn btn-outline-primary">
        <i class="fas fa-map-marker-alt"></i> Manage Addresses
    </a>
</div>

<style>
.profile-image-container {
    position: relative;
    display: inline-block;
}

.profile-image {
    width: 150px;
    height: 150px;
    border-radius: 50%;
    object-fit: cover;
    border: 4px solid var(--primary-color);
}

.profile-placeholder {
    width: 150px;
    height: 150px;
    border-radius: 50%;
    background-color: var(--primary-color);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 3rem;
    color: white;
    margin: 0 auto;
}

.profile-details .row {
    border-bottom: 1px solid #eee;
    padding: 10px 0;
}

.profile-details .row:last-child {
    border-bottom: none;
}

.address-card {
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 15px;
    background-color: #f8f9fa;
}

.address-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}

.address-text {
    margin: 0;
    color: #666;
    font-size: 0.9rem;
}
</style>
{% endblock %}
